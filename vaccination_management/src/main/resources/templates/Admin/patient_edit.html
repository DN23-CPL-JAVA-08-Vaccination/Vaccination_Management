<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
    <title>Title</title>

  <script th:src="@{//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js}"></script>
  <script th:src="@{//code.jquery.com/jquery-1.11.1.min.js}"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
  <link th:href="@{/admin/css/styles.css}" rel="stylesheet" />
  <link th:href="@{/admin/css/506.css}" rel="stylesheet" />
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
</head>
<body class="sb-nav-fixed">
<nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
  <!-- Navbar Brand-->
  <a class="navbar-brand ps-3" th:href="@{Admin/index.html}">Start Bootstrap</a>
  <!-- Sidebar Toggle-->
  <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars"></i></button>
  <!-- Navbar Search-->
  <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
    <div class="input-group">
      <input class="form-control" type="text" placeholder="Search for..." aria-label="Search for..." aria-describedby="btnNavbarSearch" />
      <button class="btn btn-primary" id="btnNavbarSearch" type="button"><i class="fas fa-search"></i></button>
    </div>
  </form>
  <!-- Navbar-->
  <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
    <li class="nav-item dropdown">
      <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-user fa-fw"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
        <li><a class="dropdown-item" href="#!">Settings</a></li>
        <li><a class="dropdown-item" href="#!">Activity Log</a></li>
        <li><hr class="dropdown-divider" /></li>
        <li><a class="dropdown-item" href="#!">Logout</a></li>
      </ul>
    </li>
  </ul>
</nav>
<div id="layoutSidenav">
  <div id="layoutSidenav_nav">
    <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
      <div class="sb-sidenav-menu">
        <div class="nav">
          <div class="sb-sidenav-menu-heading">Core</div>
          <a class="nav-link" href="index.html">
            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
            Dashboard
          </a>
          <div class="sb-sidenav-menu-heading">Addons</div>
          <a class="nav-link" href="account.html">
            <div class="sb-nav-link-icon"><i class="fas fa-circle-user"></i></div>
            Tài khoản
          </a>
          <a class="nav-link" th:href="@{/patient/view_patient}">
            <div class="sb-nav-link-icon"><i class="fas fa-hospital-user"></i></div>
            Bệnh nhân
          </a>
        </div>
      </div>
      <div class="sb-sidenav-footer">
        <div class="small">Logged in as:</div>
        Start Bootstrap
      </div>
    </nav>
  </div>
  <div id="layoutSidenav_content">
    <main>
      <div class="container-fluid px-4" style="margin-left: 300px">
        <div class="container">
          <div class="row" >
            <div class="receipt-main col-xs-10 col-sm-10 col-md-6 col-xs-offset-1 col-sm-offset-1 col-md-offset-3">

              <form th:action="@{/patient/save}" method="get" th:object="${patient}">
                <div class="container">
                  <div class="row">
                    <div class="col-10">
                      <h2 class="mb-0">Thông tin bệnh nhân</h2>
                    </div>
                    <div class="col-2">
                      <a th:href="@{/patient/view_patient}" class="btn-close float-end"></a>
                    </div>
                  </div>
                </div>
                <br>
                <div>
                  <table class="table table-bordered">
                    <thead>
                    <tr>
                      <th class="col-md-5"></th>
                      <th class="col-md-7"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <form>
                    <tr>
                      <td>ID : </td>
                      <td><input th:field="*{id}"  id="id" class="form-input" type="text" readonly>(*) </td>
                    </tr>
                    <tr>
                      <td>Họ và tên : </td>
                      <td><input th:field="*{name}"  id="name" class="form-input" type="text"  ><span style="color: red" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></span> </td>

                    </tr>

                    <tr>
                      <td>Ngày sinh : </td>
                      <td><input th:field="*{birthday}"  id="birthday" class="form-input" type="date" onchange="showGuardianFields()"  > <span  style="color: red" th:if="${#fields.hasErrors('birthday')}" th:errors="*{birthday}"></span> </td>

                    </tr>
                    <tr>
                      <td>Giới tính : </td>
                      <td>
                        <span>
                            <input class="form-check-input" type="radio" value="true" name="gender" id="Male"
                                   th:checked="${patient.gender == true}" th:text="Nam">
                                  <span style="margin-right: 10px;"></span>
                                  <input class="form-check-input" type="radio" value="false" name="gender" id="Female"
                                     th:checked="${patient.gender == false}" th:text="Nữ">
                        <span  style="color: red" th:if="${#fields.hasErrors('gender')}" th:errors="*{gender}"></span>
                        </span>
                      </td>

                    </tr>
                    <tr>
                      <td>Số điện thoại : </td>
                      <td><input th:field="*{phone}"  id="phone" class="form-input" type="text"  > <span  style="color: red" th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}"></span> </td>

                    </tr>
                    <tr>
                      <td>Địa chỉ : </td>
                      <td><input th:field="*{address}"  id="address" class="form-input" type="text"  > <span  style="color: red" th:if="${#fields.hasErrors('address')}" th:errors="*{address}"></span> </td>

                    </tr>
                      <tr>
                        <td>Email : </td>
                        <td><input th:field="*{email}"  id="email" class="form-input" type="text"  > <span  style="color: red" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></span></td>

                      </tr>
                    <tr>
                      <td >Số BHYT :</td>
                      <td><input th:field="*{healthInsurance}"  id="healthInsurance" class="form-input" type="text" readonly> (*)</td>
                    </tr>
                    <tr  id="inputContainer" style="display: none;">
                      <td >Tên người giám hộ : </td>
                      <td><input th:field="*{guardianName}"  id="input1" class="form-input" type="text"  ><span  style="color: red" th:if="${#fields.hasErrors('guardianName')}" th:errors="*{guardianName}"></span></td>

                    </tr>
                    <tr id="option1Inputs" style="display: none;">
                      <td >Số điện thoại người giám hộ : </td>
                      <td><input th:field="*{guardianPhone}"  id="input2" class="form-input" type="text"  ><span  style="color: red" th:if="${#fields.hasErrors('guardianPhone')}" th:errors="*{guardianPhone}"></span></td>

                    </tr>
                    </form>
                    </tbody>
                  </table>
                  <script>
                    function showGuardianFields() {
                      var birthdayInput = document.getElementById("birthday");
                      var inputContainer = document.getElementById("inputContainer");
                      var option1Inputs = document.getElementById("option1Inputs");
                      var guardianNameInput = document.getElementById("input1");
                      var guardianPhoneInput = document.getElementById("input2");

                      // Tính tuổi dựa vào ngày sinh và ngày hiện tại
                      var birthday = new Date(birthdayInput.value);
                      var today = new Date();
                      var age = today.getFullYear() - birthday.getFullYear();

                      // Kiểm tra năm sinh nhỏ hơn 16
                      if (age < 16) {
                        inputContainer.style.display = "table-row";
                        option1Inputs.style.display = "table-row";
                        guardianNameInput.required = true;
                        guardianPhoneInput.required = true;
                      } else {
                        inputContainer.style.display = "none";
                        option1Inputs.style.display = "none";
                        guardianNameInput.required = false;
                        guardianPhoneInput.required = false;

                        // Đặt lại giá trị rỗng cho hai trường khi birthday trên 16
                        guardianNameInput.value = "";
                        guardianPhoneInput.value = "";
                      }
                    }
                    window.onload = showGuardianFields;
                  </script>
                </div>
                <div class="row">
                  <div class="receipt-header receipt-header-mid receipt-footer">
                    <div class="container">
                        <div class="text-center">
                          <p style="font-size: 15px; color: rgba(186,192,196,0.89)">Rows that contain (*) cannot be changed</p>
                          <button  type="submit" class="btn btn-outline-success btn-sm" onclick="return save(event)">Lưu</button>
                          <a th:href="@{/patient/view_patient}" type="button" class="btn btn-outline-dark btn-sm" onclick="return cancel(event)">Thoát</a>
                      </div>
                    </div>
                    <br>
                    <div class="col-xs-8 col-sm-8 col-md-8 text-left">
                      <div class="receipt-right">
                        <h5 style="color: rgb(140, 140, 140);">Da Nang City Immunization Center</h5>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="py-4 bg-light mt-auto">
      <div class="container-fluid px-4">
        <div class="d-flex align-items-center justify-content-between small">
          <div class="text-muted">Copyright &copy; Your Website 2023</div>
          <div>
            <a href="#">Privacy Policy</a>
            &middot;
            <a href="#">Terms &amp; Conditions</a>
          </div>
        </div>
      </div>
    </footer>
  </div>
</div>
<script>
  function save(event) {
    // Sử dụng hàm confirm() để hiển thị hộp thoại xác nhận
    var result = confirm("Bạn có chắc chắn lưu chỉnh sửa thông tin bệnh nhân ?");

    // Nếu người dùng nhấn OK (đồng ý), cho phép chuyển hướng tới trang xóa bệnh nhân
    if (result) {
      return true;
    } else {
      // Nếu người dùng chọn "Cancel" (hủy), hủy bỏ việc chuyển hướng
      event.preventDefault();
      return false;
    }
  }

  function cancel(event) {
    // Sử dụng hàm confirm() để hiển thị hộp thoại xác nhận
    var result = confirm("Chỉnh sửa thông tin chưa hoàn tất! \n" +
                  "Bạn có muốn tiếp tục thoát mà không lưu ?");

    // Nếu người dùng nhấn OK (đồng ý), cho phép chuyển hướng tới trang xóa bệnh nhân
    if (result) {
      return true;
    } else {
      // Nếu người dùng chọn "Cancel" (hủy), hủy bỏ việc chuyển hướng
      event.preventDefault();
      return false;
    }
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script th:src="@{/admin/js/scripts.js}"></script>
<script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
<script th:src="@{/admin/js/datatables-simple-demo.js}"></script>

</body>
</html>